# nginx.conf

worker_processes 1;

events {
    worker_connections 1024;
}

# TCP proxy for PostgreSQL
stream {
    upstream postgres_backend {
        server postgres-primary:5432;
    }

    server {
        listen 33;
        proxy_pass postgres_backend;
        proxy_timeout 10m;
        proxy_connect_timeout 1s;
    }
}

# HTTP config for web services (your existing config)
http {
    include       mime.types;
    default_type  application/octet-stream;
    sendfile        on;
    keepalive_timeout  65;

    include /etc/nginx/conf.d/*.conf;  # Your pasted config goes in one of these *.conf files
}